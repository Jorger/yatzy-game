"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[962],{8962:function(e,n,r){r.r(n),r.d(n,{default:function(){return U}});var t=r(8683),i=r(4165),o=r(5861),u=r(9439),a=r(6058),c=r(3433),s=r(9514),l=r(9735),d=r(4654),f=r.n(d),E=function(e,n){return n.filter((function(n){return n.value===e})).length},S=function(e,n){return E(e,n)*e},v=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=!1,i=1;i<=6;i++){var o=E(i,n);if(t=r?o===e:o>=e)break}return t},O=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=!1,t=(0,c.Z)(new Set(f()(e).map((function(e){return e.value})).sort((function(e,n){return e-n})))),i=1;;){if(!(i+(n-1)<=6))break;for(var o=0,u=0;u<n;u++)o+=t.includes(u+i)?1:0;if(i++,r=o===n)break}return r},T=function(e,n){return e.reduce((function(e,r){return e+r.score[n-1].value}),0)},y=function(e,n,r){var t=e.filter((function(e){return!e.score[n-1].isUsed})).map((function(e){return{index:e.index,score:e.score[n-1].temporal}})).sort((function(e,n){return r===l.C3.HARD?n.score-e.score:e.score-n.score})),i=t.filter((function(e){return 0!==e.score})),o=t.filter((function(e){return 0===e.score}));return(null===i||void 0===i?void 0:i[0])||(null===o||void 0===o?void 0:o[0])},I=function(){var e={value:0,temporal:0,isSelected:!1,isUsed:!1,isBonusYatzy:!1};return{UPPER_SECTION:new Array(6).fill(null).map((function(n,r){var t=[e,e];return{index:r,label:l._u[r],score:t,type:l.TG.UPPER_SECTION,value:r+1}})),LOWER_SECTION:l.aA.map((function(n,r){var t=[e,e];return{index:r,label:l.AA[r],score:t,type:l.TG.LOWER_SECTION,value:n}}))}},p=function(){return new Array(5).fill(null).map((function(e,n){return{index:n,value:0,selected:!1}}))},N=function(e){for(var n=f()(e),r=0;r<n.length;r++)n[r].selected||(n[r].value=(0,s.MH)(1,6));return n},R=function(e,n,r,t,i,o){var u=f()(e),a=f()(r),c=n.type,s=n.index,d=a[t-1].isBonusEarned,E=u[c][s].score[t-1].temporal,S=!1;if(o&&"YATZY"!==u[c][s].value){var v=u.LOWER_SECTION.findIndex((function(e){return"YATZY"===e.value}));S=u.LOWER_SECTION[v].score[t-1].isUsed}var O=E+(S?l.sF.YATZY:0);u[c][s].score[t-1].isSelected=!1,u[c][s].score[t-1].isUsed=!0,u[c][s].score[t-1].isBonusYatzy=!1,u[c][s].score[t-1].value=O;var y=T(u.UPPER_SECTION,t)+(d?l.IT:0);!d&&y>=l.a8&&(a[t-1].isBonusEarned=!0,y+=l.IT);var I=T(u.LOWER_SECTION,t);a[t-1].score=y+I,a[t-1].scoreBoard={UPPER_SECTION:y,LOWER_SECTION:I};var p=function(e,n){var r=n===l.SZ.SOLO?1:2;return Object.keys(l.TG).map((function(n){for(var t=e[n],i=t.length,o=0,u=0;u<i;u++){for(var a=0,c=0;c<r;c++)a+=t[u].score[c].isUsed?1:0;o+=a===r?1:0}return o===i})).every((function(e){return e}))}(u,i);return{copyBoardState:u,copyPlayers:a,isGameOver:p}},Z=function(e,n){var r=f()(e),t=(0,s.MH)(0,4);if(n<l.kU&&t>0)for(var i=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=[];;){var r=(0,s.MH)(0,4);if(n.includes(r)||n.push(r),n.length===e)break}return n}(t),o=0;o<r.length;o++)r[o].selected=i.includes(o);return r},x=r(4832),P=r(7313),_=r(6417),C=function(e){var n=e.authUser,r=void 0===n?{}:n,c=e.difficulty,d=void 0===c?l.C3.EASY:c,E=e.typeGame,T=void 0===E?l.SZ.BOT:E,C=e.initialTurn,U=void 0===C?2:C,L=(0,P.useState)(I),h=(0,u.Z)(L,2),A=h[0],H=h[1],Y=(0,P.useState)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.SZ.SOLO,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e===l.SZ.SOLO?1:2,o={id:"",name:"",score:0,scoreBoard:{UPPER_SECTION:0,LOWER_SECTION:0},isBonusEarned:!1},u=new Array(i).fill(null).map((function(e,n){return(0,t.Z)((0,t.Z)({},o),{},{id:"player".concat(n+1),name:"Player ".concat(n+1)})}));return e!==l.SZ.SOLO&&e!==l.SZ.BOT||(u[0].name=l.ys.YOU),e===l.SZ.BOT&&(u[1].name=l.ys.BOT),u[0]=(0,t.Z)((0,t.Z)({},u[0]),n),e===l.SZ.ONLINE&&r&&(u[1]=(0,t.Z)((0,t.Z)({},u[1]),r)),u}(T,r)})),m=(0,u.Z)(Y,2),g=m[0],B=m[1],D=(0,P.useState)(T!==l.SZ.SOLO?U:1),k=(0,u.Z)(D,2),W=k[0],w=k[1],G=(0,P.useState)((function(){return p()})),b=(0,u.Z)(G,2),z=b[0],F=b[1],j=(0,P.useState)(l.EU.HIDE),M=(0,u.Z)(j,2),K=M[0],J=M[1],$=(0,P.useState)(l.kU),q=(0,u.Z)($,2),Q=q[0],V=q[1],X=(0,P.useState)(!1),ee=(0,u.Z)(X,2),ne=ee[0],re=ee[1],te=(0,P.useState)(l.HI),ie=(0,u.Z)(te,2),oe=ie[0],ue=ie[1],ae=(0,P.useState)(!1),ce=(0,u.Z)(ae,2),se=ce[0],le=ce[1],de=(0,P.useState)({isYatzy:!1,value:T===l.SZ.FRIEND?"Player ".concat(W):"",counter:T===l.SZ.FRIEND?1:0}),fe=(0,u.Z)(de,2),Ee=fe[0],Se=fe[1],ve=(0,P.useCallback)((function(e){if(e===l.yR.ROLL&&(oe.index>=0&&H((function(e){return function(e,n,r){var t=f()(e);return t[n.type][n.index].score[r-1].isSelected=!1,t[n.type][n.index].score[r-1].isBonusYatzy=!1,t}(e,oe,W)})),F((function(e){return N(e)})),J(l.EU.SPIN),V((function(e){return e-1}))),e===l.yR.PLAY){var n=R(A,oe,g,W,T,ne),r=n.copyBoardState,t=n.copyPlayers,i=n.isGameOver;if(H(r),B(t),V(l.kU),J(l.EU.HIDE),F(p()),ue(l.HI),le(i),(0,x.H_)("click"),i&&(0,x.H_)("yatzy"),!i&&T!==l.SZ.SOLO){var o=1===W?2:1;w(o),T===l.SZ.FRIEND&&Se((function(e){return{isYatzy:!1,value:"Player ".concat(o),counter:e.counter+1}}))}}}),[A,ne,oe,g,W,T]);(0,P.useEffect)((function(){var e=T===l.SZ.BOT&&2===W,n=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.gw)(1e3);case 2:F((function(e){return N(Z(e,Q))})),J(l.EU.SPIN),V((function(e){return e-1}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(!se&&e&&K===l.EU.HIDE&&n(),e&&K===l.EU.STOPPED){var r=function(e,n,r,t,i){var o=r===l.C3.MEDIUM?1===(0,s.MH)(0,1)?l.C3.HARD:l.C3.EASY:r,u=y(e.UPPER_SECTION,i,o),a=y(e.LOWER_SECTION,i,o),c=!1;(u||a)&&(u&&(c=0!==(null===u||void 0===u?void 0:u.score)),!c&&a&&(c=0!==(null===a||void 0===a?void 0:a.score)));var d=n>0&&!c&&!t,E=f()(l.HI);if(!d){if(t){var S=e.LOWER_SECTION.findIndex((function(e){return"YATZY"===e.value}));e.LOWER_SECTION[S].score[i-1].isUsed||(E.index=S,E.type=l.TG.LOWER_SECTION)}E.index<0&&(u&&a?E={HARD:u.score>a.score?{index:u.index,type:l.TG.UPPER_SECTION}:{index:a.index,type:l.TG.LOWER_SECTION},EASY:u.score<a.score?{index:u.index,type:l.TG.UPPER_SECTION}:{index:a.index,type:l.TG.LOWER_SECTION}}[o]:(u&&(E.index=u.index,E.type=l.TG.UPPER_SECTION),a&&(E.index=a.index,E.type=l.TG.LOWER_SECTION)))}return{rollAgain:d,itemSelected:E}}(A,Q,d,ne,W),t=r.rollAgain,u=void 0!==t&&t,a=r.itemSelected;u?n():ue(a)}se||K!==l.EU.SPIN||(0,x.H_)("dice")}),[A,K,d,se,ne,Q,W,T]),(0,P.useEffect)((function(){var e=T===l.SZ.BOT&&2===W,n=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.gw)(2e3);case 2:ve(l.yR.PLAY);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e&&oe.index>=0&&n()}),[ve,oe,W,T]);var Oe=T===l.SZ.ONLINE?{stop:!1,onEndCountdown:function(e){console.log({player:e})}}:void 0,Te=1===W||T===l.SZ.FRIEND,ye=!se&&(T===l.SZ.BOT||T===l.SZ.ONLINE)&&2===W,Ie=ye||se||K===l.EU.SPIN||Q<=0||0===function(e){return e.filter((function(e){return!e.selected})).length}(z),pe=ye||K===l.EU.SPIN||oe.index<0,Ne=!se&&K!==l.EU.HIDE&&Te,Re=l._B[Te?"WHITE":"RED"],Ze=Te&&K===l.EU.STOPPED;return(0,_.jsxs)(a.sw,{blockContent:ye,children:[se&&(0,_.jsx)(a.N0,{players:g}),(0,_.jsx)(a.xP,(0,t.Z)({},Ee)),(0,_.jsx)(a.h4,{countdown:Oe,players:g,turn:W}),(0,_.jsx)(a.$l,{items:A,players:g,thrownDice:Ze,turn:W,typeGame:T,handleClick:function(e,n){var r=function(e,n,r,t){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=f()(e),u=f()(l.HI),a=!1;if(!o[r.type][r.index].score[t-1].isUsed){if(n.index>=0&&(o[n.type][n.index].score[t-1].isSelected=!1,o[n.type][n.index].score[t-1].isBonusYatzy=!1),n.index!==r.index||n.type!==r.type){u.index=r.index,u.type=r.type,o[r.type][r.index].score[t-1].isSelected=!0;var c=0!==o.LOWER_SECTION.filter((function(e){return"YATZY"===e.value&&e.score[t-1].isUsed})).length;o[r.type][r.index].score[t-1].isBonusYatzy=c&&i}a=!0}return{changeState:a,copyBoardState:o,newItemSelected:u}}(A,oe,e,n,ne),t=r.changeState,i=r.copyBoardState,o=r.newItemSelected;t&&((0,x.H_)("click"),H(i),ue(o))}}),(0,_.jsx)(a.WN,{dieState:K,values:z,diceTheme:Re,handleDoneDices:function(){var e=function(e,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,t=JSON.parse(JSON.stringify(e)),i=function(e){return e.reduce((function(e,n){return e+n.value}),0)}(n),o=v(3,n),u=v(4,n),a=v(3,n,!0)&&v(2,n,!0),c=O(n,4),s=O(n,5),d=v(5,n),f={THREE_KIND:o?i:0,FOUR_KIND:u?i:0,FULL_HOUSE:a?l.sF.FULLHOUSE:0,SMALL_STRAIGHT:c?l.sF.SMALL_STRAIGHT:0,LARGE_STRAIGHT:s?l.sF.LARGE_STRAIGHT:0,YATZY:d?l.sF.YATZY:0,CHANCE:i},E=0;E<t.UPPER_SECTION.length;E++){var T;if(null===(T=t.UPPER_SECTION[E].score[r-1])||void 0===T||!T.isUsed){var y=t.UPPER_SECTION[E].value,I=S(y,n);t.UPPER_SECTION[E].score[r-1].temporal=I}}for(var p=0;p<t.LOWER_SECTION.length;p++){var N,R=t.LOWER_SECTION[p].value;null!==(N=t.LOWER_SECTION[p].score[r-1])&&void 0!==N&&N.isUsed||(t.LOWER_SECTION[p].score[r-1].temporal=f[R])}return{isYatzy:d,copyBoardState:t}}(A,z,W),n=e.copyBoardState,r=e.isYatzy;H(n),re(r),J(l.EU.STOPPED),ue(l.HI),r&&(Se((function(e){return{isYatzy:!0,value:"Yatzy",counter:e.counter+1}})),(0,x.H_)("yatzy"))},handleSelectDice:function(e){(0,x.H_)("click"),F(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=f()(e);return r[n].selected=!r[n].selected,r}(z,e))}}),(0,_.jsx)(a.EK,{disabledPlay:pe,disabledRoll:Ie,showPlay:Ne,throwing:Q,handleClick:ve})]})},U=P.memo(C)}}]);